{% extends "base.html" %}
{% block title %}Search · SHK CMS{% endblock %}

{% block content %}
<h1 class="h4 mb-3">Search</h1>

<div class="card shadow-sm mb-3">
  <div class="card-body">
    <form method="POST" action="/search" class="row g-3">
      <div class="col-12 col-md-3">
        <label class="form-label">Bank</label>
        <select class="form-select" name="bank" required>
          <option value="ICICI">ICICI</option>
          <option value="HDFC">HDFC</option>
          <option value="HDFC Athiyan">HDFC Athiyan</option>
        </select>
      </div>
      <div class="col-12 col-md-3">
        <label class="form-label">Vendor</label>
        <select class="form-select" name="vendor">
          <option value="">All Vendors</option>
          {% for v in vendor_list %}
          <option value="{{ v }}">{{ v }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-6 col-md-2">
        <label class="form-label">Cheque No</label>
        <input type="number" class="form-control" name="cheque_no">
      </div>
      <div class="col-6 col-md-2">
        <label class="form-label">From</label>
        <input type="date" class="form-control" name="from_date">
      </div>
      <div class="col-6 col-md-2">
        <label class="form-label">To</label>
        <input type="date" class="form-control" name="to_date">
      </div>
      <div class="col-12">
        <button class="btn btn-primary"><i class="bi bi-search"></i> Search</button>
      </div>
    </form>
  </div>
</div>

<!-- Summary -->
<div class="row g-3">
  <div class="col-12 col-lg-4">
    <div class="card shadow-sm h-100">
      <div class="card-header bg-white"><strong>Summary</strong></div>
      <div class="card-body">
        <div class="row text-center g-3">
          <div class="col-6">
            <div class="p-3 bg-light rounded">
              <div class="small text-muted">Cheques</div>
              <div class="fs-5 fw-semibold">{{ total_cheques }}</div>
            </div>
          </div>
          <div class="col-6">
            <div class="p-3 bg-light rounded">
              <div class="small text-muted">Active</div>
              <div class="fs-5 fw-semibold">{{ active_cheques }}</div>
            </div>
          </div>
          <div class="col-12">
            <div class="p-3 bg-light rounded">
              <div class="small text-muted">Total Amount</div>
              <div class="fs-5 fw-semibold">₹ {{ total_amount }}</div>
            </div>
          </div>
          <div class="col-6">
            <div class="p-3 bg-light rounded">
              <div class="small text-muted">Cashed</div>
              <div class="fs-6 fw-semibold">₹ {{ cashed_amount }}</div>
            </div>
          </div>
          <div class="col-6">
            <div class="p-3 bg-light rounded">
              <div class="small text-muted">To be Cashed</div>
              <div class="fs-6 fw-semibold">₹ {{ active_amount }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Results -->
  <div class="col-12 col-lg-8">
    <div class="card shadow-sm">
      <div class="card-header bg-white"><strong>Results</strong></div>
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table table-hover mb-0">
            <thead class="table-light">
              <tr>
                <th>Bank</th><th>Cheque No</th><th class="text-end">Amount</th>
                <th>Issue Date</th><th>Realisation Date</th><th>Vendor</th><th>Status</th><th>Status Date</th>
              </tr>
            </thead>
            <tbody>
              {% for row in results %}
              <tr>
                <td>{{ row.bank }}</td>
                <td>{{ row.cheque_no }}</td>
                <td class="text-end">{{ row.amount }}</td>
                <td>{{ row.issue_date }}</td>
                <td>{{ row.post_date }}</td>
                <td>{{ row.vendor }}</td>
                <td>{{ row.status }}</td>
                <td>{{ row.status_date }}</td>
              </tr>
              {% else %}
              <tr><td colspan="8" class="text-center text-muted">No results</td></tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
